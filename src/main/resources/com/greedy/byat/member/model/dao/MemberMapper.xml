<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.greedy.byat.member.model.dao.MemberMapper">
 	
 	<resultMap id="memberResultMap" type="MemberDTO">
 		<id property="no" column="MEMBER_NO"/>
 		<result property="permit" column="MEMBER_PERMIT"/>
 		<result property="id" column="MEMBER_ID"/>
 		<result property="pwd" column="MEMBER_PWD"/>
 		<result property="name" column="MEMBER_NAME"/>
 		<result property="phone" column="MEMBER_PHONE"/>
 		<result property="email" column="MEMBER_EMAIL"/>
 		<result property="absenceYN" column="ABSENCE_YN"/>
 		<result property="initPwdYN" column="INIT_PWD_YN"/>
 	</resultMap>
 	
 	
 	<select id="selectEncryptedPwd" resultType="java.lang.String">
 		SELECT
 		       A.MEMBER_PWD
 		  FROM TBL_MEMBER A
 		 WHERE A.ABSENCE_YN = 'N'
 		   AND A.MEMBER_ID = #{ id }
 	
 	</select>
 
 	<select id="login" resultMap="memberResultMap">
 		SELECT
 		       A.MEMBER_NO
 		     , A.MEMBER_PERMIT
 		     , A.MEMBER_ID
 		     , A.MEMBER_PWD
 		     , A.MEMBER_NAME
 		     , A.MEMBER_PHONE
 		     , A.MEMBER_EMAIL
 		     , A.ABSENCE_YN
 		     , A.INIT_PWD_YN
 		  FROM TBL_MEMBER A
 		 WHERE A.ABSENCE_YN = 'N'
 		   AND A.INIT_PWD_YN = 'N'
 		   AND A.MEMBER_ID = #{ id }
 	
 	</select>
 
 	<select id="initLogin" resultMap="memberResultMap">
 		SELECT
 		       A.MEMBER_NO
 		     , A.MEMBER_PERMIT
 		     , A.MEMBER_ID
 		     , A.MEMBER_PWD
 		     , A.MEMBER_NAME
 		     , A.MEMBER_PHONE
 		     , A.MEMBER_EMAIL
	      	 , A.ABSENCE_YN
 		     , A.INIT_PWD_YN
 		  FROM TBL_MEMBER A
 		 WHERE A.ABSENCE_YN = 'N'
 		   AND A.INIT_PWD_YN = 'Y'
 		   AND A.MEMBER_ID = #{ id }
 	</select>
 	
	<select id="selectInitPasswordYN" resultType="java.lang.String">
		SELECT
		       A.INIT_PWD_YN
		  FROM TBL_MEMBER A
		 WHERE A.MEMBER_ID = #{ id }
	</select> 
	
	<select id="emailduplicationCheck" resultType="java.lang.String">
		SELECT
		       A.MEMBER_EMAIL
		  FROM TBL_MEMBER A
		 WHERE A.ABSENCE_YN = 'N'
		   AND A.MEMBER_ID = #{ id }
	</select>
		
	<select id="selectEmailById" resultType="java.lang.String">
		SELECT
		       A.MEMBER_EMAIL
		  FROM TBL_MEMBER A
		 WHERE A.ABSENCE_YN = 'N'
		   AND A.MEMBER_ID = #{ id } 
	</select>
	
	<insert id="insertverification" parameterType="_int">
		INSERT 
		  INTO TBL_VERIFICATION A 
		( 
		   A.VERIFICATION_NUM_CODE
		 , A.VERIFICATION_NUM_KEY
		 , A.VERIFICATION_NUM_TYPE
		 , A.VERIFICATION_NUM_CREATED_DATE
		 , A.VERIFICATION_NUM_USED_DATE
		 , A.VERIFICATION_NUM_DESTRUCTION_YN
		 , A.MEMBER_NO
		)
		VALUES
		(
		   SEQ_VERIFICATION_NUM_CODE.NEXTVAL
		 , 34214
		 , '멤버비밀번호찾기'
		 , SYSDATE
		 , SYSDATE
		 , 'N'
		 , 14
		)
		
		<!-- INSERT 
		  INTO TBL_VERIFICATION A 
		( 
		   A.VERIFICATION_NUM_CODE
		 , A.VERIFICATION_NUM_KEY
		 , A.VERIFICATION_NUM_TYPE
		 , A.VERIFICATION_NUM_CREATED_DATE
		 , A.VERIFICATION_NUM_USED_DATE
		 , A.VERIFICATION_NUM_DESTRUCTION_YN
		 , A.MEMBER_NO
		)
		VALUES
		(
		   SEQ_VERIFICATION_NUM_CODE.NEXTVAL
		 , 34214
		 , '멤버비밀번호찾기'
		 , SYSDATE
		 , SYSDATE
		 , 'N'
		 , 14
		) -->
	</insert>
	
 </mapper>